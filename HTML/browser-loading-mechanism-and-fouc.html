<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.38">
    <script>
      const userMode = localStorage.getItem('vuepress-reco-color-scheme');
      const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

      if (userMode === 'dark' || (typeof userMode !== 'string' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true);
      }
    </script>
    <link rel="icon" href="./favicon.ico"><title>浏览器的加载机制与白屏现象 | CrabSAMA · 笔记</title><meta name="description" content="记录程序狗的点点滴滴">
    <link rel="preload" href="/CrabSAMA-Blog/assets/js/runtime~app.d3aa398f.js" as="script"><link rel="preload" href="/CrabSAMA-Blog/assets/css/styles.2370ad64.css" as="style"><link rel="preload" href="/CrabSAMA-Blog/assets/js/3769.e5740029.js" as="script"><link rel="preload" href="/CrabSAMA-Blog/assets/js/app.7dc44c0d.js" as="script">
    <link rel="stylesheet" href="/CrabSAMA-Blog/assets/css/styles.2370ad64.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><div class="common-wrapper no-sidebar"><header class="navbar-container"><div class="toggle-sidebar-button" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span class="site-brand"><a href="/CrabSAMA-Blog/" class=""><img class="logo" src="/CrabSAMA-Blog/assets/img/logoa.png" alt="CrabSAMA · 笔记"><span class="site-name can-hide">CrabSAMA · 笔记</span></a></span><div class="navbar-links-wrapper" style=""><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/CrabSAMA-Blog/" class="nav-link" aria-label="CrabLoveWelcome"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->CrabLoveWelcome<!--]--></span></a><!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="分类"><a class="icon-container left title" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->分类<!--]--></span></a><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="分类"><a class="icon-container left title" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->分类<!--]--></span></a><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/JavaScript/1/" class="nav-link" aria-label="JavaScript"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->JavaScript<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/TypeScript/1/" class="nav-link" aria-label="TypeScript"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->TypeScript<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/qianduangongchenghua/1/" class="nav-link" aria-label="前端工程化"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->前端工程化<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/bishiti/1/" class="nav-link" aria-label="笔试题"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->笔试题<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/kaifaguifan/1/" class="nav-link" aria-label="开发规范"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->开发规范<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/shijixiangmu/1/" class="nav-link" aria-label="实际项目"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->实际项目<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/jisuanjiwangluo/1/" class="nav-link" aria-label="计算机网络"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->计算机网络<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/Node.js/1/" class="nav-link" aria-label="Node.js"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->Node.js<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/git/1/" class="nav-link" aria-label="Git"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->Git<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/HTML/1/" class="nav-link" aria-label="HTML"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->HTML<!--]--></span></a><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><a class="icon-container left btn-toggle-dark-mode" href="javascript:void(0)"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" style="color:inherit;width:20px;height:20px;font-size:20px;"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3h.393a7.5 7.5 0 0 0 7.92 12.446A9 9 0 1 1 12 2.992z"></path><path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0-2 2a2 2 0 0 0-2-2a2 2 0 0 0 2-2"></path><path d="M19 11h2m-1-1v2"></path></g></svg><!----></a></div></header><div class="sidebar-mask"></div><aside class="series-container"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/CrabSAMA-Blog/" class="nav-link" aria-label="CrabLoveWelcome"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->CrabLoveWelcome<!--]--></span></a><!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="分类"><a class="icon-container left title" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->分类<!--]--></span></a><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="分类"><a class="icon-container left title" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->分类<!--]--></span></a><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/JavaScript/1/" class="nav-link" aria-label="JavaScript"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->JavaScript<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/TypeScript/1/" class="nav-link" aria-label="TypeScript"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->TypeScript<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/qianduangongchenghua/1/" class="nav-link" aria-label="前端工程化"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->前端工程化<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/bishiti/1/" class="nav-link" aria-label="笔试题"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->笔试题<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/kaifaguifan/1/" class="nav-link" aria-label="开发规范"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->开发规范<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/shijixiangmu/1/" class="nav-link" aria-label="实际项目"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->实际项目<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/jisuanjiwangluo/1/" class="nav-link" aria-label="计算机网络"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->计算机网络<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/Node.js/1/" class="nav-link" aria-label="Node.js"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->Node.js<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/git/1/" class="nav-link" aria-label="Git"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->Git<!--]--></span></a><!--[--><!--]--></a></li><li class="dropdown-item"><a href="/CrabSAMA-Blog/categories/HTML/1/" class="nav-link" aria-label="HTML"><!--[--><!--]--><a class="icon-container left" href="javascript:void(0)"><!----><span style="color:inherit;font-size:14px;"><!--[-->HTML<!--]--></span></a><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--></aside><!--[--><main class="page-container"><h1 class="page-title">浏览器的加载机制与白屏现象</h1><div class="page-info"><!----><a class="icon-container left" href="javascript:void(0)"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" style="color:inherit;width:18px;height:18px;font-size:18px;"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 7v5l3 3"></path></g></svg><span style="color:inherit;font-size:14px;"><!--[-->2020-08-19 08:07:44<!--]--></span></a><a class="icon-container left" href="javascript:void(0)"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" style="color:inherit;width:18px;height:18px;font-size:18px;"><path d="M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg><span style="color:inherit;font-size:14px;"><!--[--><!--[--><a href="/CrabSAMA-Blog/categories/HTML/1/" class="category">HTML</a><!--]--><!--]--></span></a><!----><!----></div><div class="theme-reco-default-content"><!--[--><p><strong>从资源请求完成到页面的显示：</strong></p><ol><li>解析<code>HTML</code>字符串构建<code>DOM</code>树</li><li>解析<code>CSS</code>样式，产生<code>CSSOM</code>树</li><li>执行<code>js</code>脚本文件，<code>js</code>加载完成，通过<code>DOM API</code> 和 <code>CSSOM API</code> 来操作<code>DOM</code>树和<code>CSSOM</code>树</li><li>浏览器根据<code>DOM</code>树和<code>CSSOM</code>树构建渲染树（rendering tree），渲染树包括显示的节点和节点显示的样式信息，如果某个节点设置了样式 <code>display: none</code>，那么就不会在渲染树中显示，如果设置<code>visibility:hidden</code>渲染树中存在该节点，但不显示。</li><li>根据渲染树对每一个节点在页面上进行布局。（<code>reflow</code>）</li><li>遍历渲染树，为每一个节点绘制对应的样式，显示到屏幕。(<code>repaint</code>)</li></ol><p><img src="/CrabSAMA-Blog/assets/img/image-20220627103856499.cf756070.png" alt="image-20220627103856499"></p><p>白屏和<code>FOUC</code>主要是由于不同浏览器在加载资源时产生的不同问题。</p><p><strong><code>FOUC</code>（无样式内容闪烁）</strong></p><p><code>FOUC</code>是浏览器在加载资源时，加载多少渲染多少，直至完全加载成并计算渲染成功为止。 <strong>白屏</strong></p><p>白屏是浏览器未加载完全部资源时，<strong>选择等待全部资源加载完成</strong>之后再进行计算和渲染的等待加载过程。</p><p><strong>关于<code>CSS</code>和<code>JS</code>的放置顺序：</strong></p><ul><li><strong>使用<code>link</code>标签将样式表放在顶部</strong>，是为了让<code>css</code>优先加载，防止页面上其他元素（图片，音频，视频等）的加载影响<code>css</code>的加载，同时<code>css</code>也会影响这些元素的加载（例如：浏览器的队列时间等）</li><li><strong>将<code>js</code>文件放在底部</strong><ol><li>脚本会阻塞后面内容的呈现（需要等待脚本加载完成之后页面内的元素才会被呈现）</li><li>脚本会阻塞后面组件的下载（主要是影响图片和其他音频视频等资源的加载）</li><li>脚本用于操作页面上的元素，放在顶部时，元素仍未加载，未出现在文档流中容易出现报错。</li><li>脚本加载完成之后立即执行，如若碰到执行时间比较长，大量计算，循环甚至死循环时会影响后面资源的加载。</li><li>当我们使用一个<strong>决定页面上所有元素的呈现的框架</strong>时，可以将其放<strong>置于顶部</strong>，因为该框架不加载好、未执行，页面都是一片空白或是以混乱的样式呈现。</li></ol></li><li>对于<strong>图片和和<code>css</code></strong>，在<strong>加载时会并发加载</strong>（如一个域名下同时加载两个文件）。但是加载<code>JavaScript</code>时，会禁用并发，并且阻止其他内容的下载，所以将<code>JavaScript</code>放在页面顶部也会导致白屏现象。</li></ul><p><strong>加载异步</strong></p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>script.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"> </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">async</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>script.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">defer</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>script.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>没有<code>defer</code>或<code>async</code>，浏览器会立即加载并执行<strong>指定的脚本。“立即”指的是在渲染该<code>script</code>标签之下的文档元素之前，也就是说不等待后续载入的文档元素，读到就加载并执行。</strong></li><li>有<code>async</code>，加载后续文档元素的过程和<strong>js的加载与执行</strong>并行进行（异步）。</li><li>有<code>defer</code>，加载后续文档的过程和<code>js</code>的<strong>加载</strong>并行进行（异步），但<code>js</code>的<strong>执行</strong>要在所有元素解析完成之后，<code>DOMContentLoaded</code>事件触发之前完成。</li></ul><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><a class="icon-container left meta-item-label" href="javascript:void(0)"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" style="color:inherit;width:20px;height:20px;font-size:20px;"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11.795 21H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4"></path><circle cx="18" cy="18" r="4"></circle><path d="M15 3v4"></path><path d="M7 3v4"></path><path d="M3 11h16"></path><path d="M18 16.496V18l1 1"></path></g></svg><span style="color:inherit;font-size:14px;"><!--[-->Last Updated 2022-06-27 03:49:32<!--]--></span></a></div></footer><!----><!----></main><!--]--><!----></div></div><!----><!----><!--]--></div>
    <script src="/CrabSAMA-Blog/assets/js/runtime~app.d3aa398f.js" defer></script><script src="/CrabSAMA-Blog/assets/js/3769.e5740029.js" defer></script><script src="/CrabSAMA-Blog/assets/js/app.7dc44c0d.js" defer></script>
  </body>
</html>
