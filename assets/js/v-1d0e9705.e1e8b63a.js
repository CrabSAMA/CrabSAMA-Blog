"use strict";(self.webpackChunkcrabsama_blog=self.webpackChunkcrabsama_blog||[]).push([[8759],{6927:(n,s,a)=>{a.r(s),a.d(s,{data:()=>t});const t={key:"v-1d0e9705",path:"/%E5%AE%9E%E9%99%85%E9%A1%B9%E7%9B%AE/vue-white-page-loading.html",title:"Vue首屏加载优化项目实践",lang:"zh-CN",frontmatter:{title:"Vue首屏加载优化项目实践",sidebar:"auto",categories:["实际项目"]},excerpt:"",headers:[{level:2,title:"路由懒加载",slug:"路由懒加载",children:[]},{level:2,title:"使用CDN资源",slug:"使用cdn资源",children:[{level:3,title:"分析",slug:"分析",children:[]},{level:3,title:"加载流程",slug:"加载流程",children:[]}]}],git:{createdTime:1652167657e3,updatedTime:1652173144e3,contributors:[{name:"CrabSAMA",email:"71915282@qq.com",commits:2}]},filePathRelative:"实际项目/vue-white-page-loading.md"}},7193:(n,s,a)=>{a.r(s),a.d(s,{default:()=>Q});var t=a(6252);const p=a.p+"assets/img/image.9f85eccd.png",e=a.p+"assets/img/image-5.68ca82fc.png",o=a.p+"assets/img/image-1.9ab218a6.png",l=a.p+"assets/img/image-2.0a235958.png",c=a.p+"assets/img/image-3.e128583a.png",r=(0,t._)("p",null,"提升90%加载速度——vuecli下的首屏性能优化",-1),u={href:"https://segmentfault.com/a/1190000019499007",target:"_blank",rel:"noopener noreferrer"},i=(0,t.Uk)("链接"),k=(0,t._)("p",null,"Vue SPA 首屏加载优化实践",-1),m={href:"https://juejin.im/post/5a291092518825293b50366d",target:"_blank",rel:"noopener noreferrer"},b=(0,t.Uk)("链接"),g=(0,t.uE)('<p>最近项目进行到了尾声，处于修改、测试阶段，老板对我们的项目中加载速度提出了一些意见。由于当前服务器部署在阿里云学生机上面，上下传速度只有1mbps，约等于140kb/s的速度，虽然前端打包下来只有5m左右的大小，在测试的过程中还是遇到了白屏时间巨久的情况：PC端载入10s左右，移动端载入20-30s左右，这实在是不能让人接受。因此，现在我要对我的项目进行一些优化，使得白屏现象得以改善。</p><p><img src="'+p+'" alt=""></p><p style="text-align:center;">未优化前</p><p>可以看到的是，在没有优化前，chunk-vendors文件已经有6.25MB之大，而这个文件在每次打开页面的时候都会进行一次加载，从而导致加载时间巨久无比。</p><hr><p>在开始对项目进行优化之前，我寻找了一些资料，链接我放在了文章的最开头，可以点链接进入查看。在查找资料的过程中，我决定从这几方面下手：</p><ul><li>路由懒加载（在之前已经实现了）</li><li>常用模块通过CDN进行加载</li><li>gzip压缩（未实现，需要后端配合）</li></ul><h2 id="路由懒加载" tabindex="-1"><a class="header-anchor" href="#路由懒加载" aria-hidden="true">#</a> 路由懒加载</h2><p>在之前我已经对vue-route进行改造，全部使用了懒加载模式</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>\n    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&quot;/main&quot;</span><span class="token punctuation">,</span>\n    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;../../views/PC/Main.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;首页&quot;</span><span class="token punctuation">,</span>\n      <span class="token literal-property property">requireLogin</span><span class="token operator">:</span> <span class="token boolean">true</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>重点代码就是这一行 <code>() =&gt; import(&quot;../../views/PC/Main.vue&quot;)</code> 就是这么简单，将组件引入格式改成这样即可实现路由懒加载。<br> 原理是：以函数的形式动态引入，这样就可以把各自的路由文件分别打包，只有在解析给定的路由时，才会下载路由组件。 这里面还有其他写法，见下图</p><p><img src="'+e+'" alt=""></p><p style="text-align:center;">路由懒加载的不同写法</p>',13),d=(0,t.Uk)("虽然是对route进行了处理，但是实际运行时，我还是发现在加载首页的时候，就加载了一堆不相关的chunk文件，实际上来说还是没有实际减少加载量的效果，这又是为什么呢？ 在查阅了"),h={href:"https://segmentfault.com/a/1190000019499007",target:"_blank",rel:"noopener noreferrer"},v=(0,t.Uk)("《提升90%加载速度——vuecli下的首屏性能优化》"),q=(0,t.Uk)("这篇文章后，我发现了一个概念："),f=(0,t._)("strong",null,"prefetch",-1),y=(0,t._)("blockquote",null,[(0,t._)("p",null,[(0,t._)("strong",null,"prefetch")]),(0,t._)("p",null,[(0,t.Uk)("如果是在"),(0,t._)("code",null,"vuecli 3"),(0,t.Uk)("中，我们还需要多做一步工作。因为"),(0,t._)("code",null,"vuecli 3"),(0,t.Uk)("默认开启"),(0,t._)("code",null,"prefetch"),(0,t.Uk)("(预先加载模块)，提前获取用户未来可能会访问的内容，在首屏会把这十几个路由文件，都一口气下载了。所以我们要关闭这个功能，在"),(0,t._)("code",null,"vue.config.js"),(0,t.Uk)("中设置")])],-1),x=(0,t.Uk)("在不作任何处理的情况下，vue-cli 3会默认开启"),j=(0,t._)("code",null,"Prefetch",-1),_=(0,t.Uk)("功能（"),w={href:"https://cli.vuejs.org/zh/guide/html-and-static-assets.html#prefetch",target:"_blank",rel:"noopener noreferrer"},E=(0,t.Uk)("cli文档"),U=(0,t.Uk)("）"),V=(0,t.Uk)("默认情况下，一个 Vue CLI 应用会为所有作为 async chunk 生成的 JavaScript 文件 ("),C={href:"https://webpack.js.org/guides/code-splitting/#dynamic-imports",target:"_blank",rel:"noopener noreferrer"},A=(0,t.Uk)("通过动态 "),N=(0,t._)("code",null,"import()",-1),L=(0,t.Uk)(" 按需 code splitting"),W=(0,t.Uk)(" 的产物) 自动生成 prefetch 提示。"),M=(0,t.Uk)("这就等于说，在没有任何操作的情况下，所有懒加载的组件，都会被标记上"),T={href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Link_prefetching_FAQ",target:"_blank",rel:"noopener noreferrer"},B=(0,t._)("link",{rel:"prefetch"},null,-1),D=(0,t.Uk)("标记，浏览器将会一次性全都加载下来，因为你标记了即将使用到嘛，很简单的道理。很明确的是，我们不想要见到这种效果，我们想要路由懒加载的原因就是想要运用到了才加载，因此我们需要关闭这个功能，而关闭的方法也很简单"),P=(0,t.uE)('<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// vue.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token function-variable function">chainWebpack</span><span class="token operator">:</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 移除 prefetch 插件</span>\n    config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&#39;prefetch&#39;</span><span class="token punctuation">)</span>\n\n    <span class="token comment">// 或者</span>\n    <span class="token comment">// 修改它的选项：</span>\n    config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">&#39;prefetch&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token parameter">options</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n      options<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fileBlacklist <span class="token operator">=</span> options<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fileBlacklist <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n      options<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fileBlacklist<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">myasyncRoute(.)+?\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>\n      <span class="token keyword">return</span> options\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>设置完毕后，首屏就只会加载当前页面路由的组件了。</p><h2 id="使用cdn资源" tabindex="-1"><a class="header-anchor" href="#使用cdn资源" aria-hidden="true">#</a> 使用CDN资源</h2><p>我们要将 <code>vue</code>、 <code>vue-router</code>、 <code>vuex</code>、<code>element-ui</code> 从 <code>vendor.js</code> 中分离出来，使用CDN资源引入。这些都是chunk-vendors.js里面的大头，我们可以通过vuecli3中vue ui打开的dashboard中“分析”看得出。</p><p><img src="'+o+'" alt=""></p><h3 id="分析" tabindex="-1"><a class="header-anchor" href="#分析" aria-hidden="true">#</a> 分析</h3><p>1、首先在模板文件<code>index.html</code>中添加以下内容：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>...\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width,initial-scale=1.0,user-scalable=no<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n    <span class="token comment">&lt;!--&lt;script src=&quot;http://res.wx.qq.com/open/js/jweixin-1.6.0.js&quot;&gt;&lt;/script&gt;--&gt;</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>&lt;%= BASE\\_URL %&gt;favicon.ico<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/element-ui/2.13.1/theme-chalk/index.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://res.wx.qq.com/open/libs/weui/2.3.0/weui.min.css<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/vue/2.6.11/vue.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/vuex@3.4.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/vue-router@3.1.6/dist/vue-router.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/element-ui/2.13.1/index.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/echarts/4.7.0/echarts.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://gw.alipayobjects.com/os/antv/pkg/\\_antv.g6-3.2.8/build/g6.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>\n  ...\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div>',8),R=(0,t.Uk)("2、修改 "),z=(0,t._)("code",null,"vue.config.js",-1),S=(0,t.Uk)("。（如果没有该文件，请与package.json同级下建立该文件，详情可见vuecli3文档） "),I={href:"https://webpack.docschina.org/configuration/externals/",target:"_blank",rel:"noopener noreferrer"},H=(0,t._)("code",null,"externals",-1),F=(0,t.Uk)(" 配置项"),G=(0,t.uE)('<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token operator">...</span>\n  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">externals</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token literal-property property">vue</span><span class="token operator">:</span> <span class="token string">&quot;Vue&quot;</span><span class="token punctuation">,</span>\n      <span class="token literal-property property">vuex</span><span class="token operator">:</span> <span class="token string">&quot;Vuex&quot;</span><span class="token punctuation">,</span>\n      <span class="token string-property property">&quot;vue-router&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VueRouter&quot;</span><span class="token punctuation">,</span>\n      <span class="token string-property property">&quot;element-ui&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ELEMENT&quot;</span><span class="token punctuation">,</span>\n      <span class="token literal-property property">echarts</span><span class="token operator">:</span> <span class="token string">&quot;echarts&quot;</span><span class="token punctuation">,</span>\n      <span class="token string-property property">&quot;@antv/g6&quot;</span><span class="token operator">:</span> <span class="token string">&quot;G6&quot;</span>\n    <span class="token punctuation">}</span>\n    <span class="token operator">...</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>3、修改 <code>src/router/index.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// import Vue from &#39;vue&#39;</span>\n<span class="token keyword">import</span> VueRouter <span class="token keyword">from</span> <span class="token string">&#39;vue-router&#39;</span>\n<span class="token comment">// 注释掉</span>\n<span class="token comment">// Vue.use(VueRouter)</span>\n<span class="token operator">...</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>4、修改 <code>src/store/index.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">...</span>\n<span class="token comment">// 注释掉</span>\n<span class="token comment">// Vue.use(Vuex)</span>\n<span class="token operator">...</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>5、修改 <code>src/main.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>\n<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&#39;./App&#39;</span>\n<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&#39;axios&#39;</span>\n<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&#39;./store&#39;</span>\n<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">&#39;./router&#39;</span>\n<span class="token keyword">import</span> <span class="token constant">ELEMENT</span> <span class="token keyword">from</span> <span class="token string">&#39;element-ui&#39;</span>\n<span class="token comment">// import &#39;element-ui/lib/theme-chalk/index.css&#39;</span>\n\nVue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token constant">ELEMENT</span><span class="token punctuation">)</span>\n\n<span class="token operator">/</span>\\<span class="token operator">*</span> eslint<span class="token operator">-</span>disable no<span class="token operator">-</span><span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\\</span></span><span class="token operator">*</span><span class="token operator">/</span>\n<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">&#39;#app&#39;</span><span class="token punctuation">,</span>\n  store<span class="token punctuation">,</span>\n  router<span class="token punctuation">,</span>\n  <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&#39;&lt;App/&gt;&#39;</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span> App <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>注意！这里 <code>element-ui</code> 变量名要使用 <code>ELEMENT</code>，因为<code>element-ui</code>的 umd 模块名是 <code>ELEMENT</code></p><p>在进行了这一系列操作之后，成功的将chunk-vendors.js降低到877.9kb！这已经是十分大的一个进步！</p><p><img src="'+l+'" alt=""></p><p>从这里依赖项也可以看出，vue、vue-router、vuex、element-ui已经被干掉了，取而代之的是在载入时通过CDN加载模块。（可以看到还有antv/g6、xlsx、cube-ui等没有用CDN加载，主要是还没找到好的办法555）</p><hr><p>折腾了一下午+一晚上，可算是把加载速度降到可以接受的范围了（1.74s，部署在局域网服务器上）</p><p><img src="'+c+'" alt=""></p><h3 id="加载流程" tabindex="-1"><a class="header-anchor" href="#加载流程" aria-hidden="true">#</a> 加载流程</h3><p>虽然已经达到了一些效果，但是我仍然有一些问题没有解决</p><ol><li>gzip的开启</li><li>以Element-ui为例，我知道了它的umd名称，所以可以做到在externals内排除掉，但是如果是@antv/g6这种呢？要如何才可以在externals中排除掉？</li></ol><hr><p><strong>每天一点进步，总可以实现心中想要的东西！</strong></p>',19),J={},Q=(0,a(3744).Z)(J,[["render",function(n,s){const a=(0,t.up)("ExternalLinkIcon");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("blockquote",null,[r,(0,t._)("p",null,[(0,t._)("a",u,[i,(0,t.Wm)(a)])])]),(0,t._)("blockquote",null,[k,(0,t._)("p",null,[(0,t._)("a",m,[b,(0,t.Wm)(a)])])]),g,(0,t._)("p",null,[d,(0,t._)("a",h,[v,(0,t.Wm)(a)]),q,f]),y,(0,t._)("p",null,[x,j,_,(0,t._)("a",w,[E,(0,t.Wm)(a)]),U]),(0,t._)("p",null,[V,(0,t._)("a",C,[A,N,L,(0,t.Wm)(a)]),W]),(0,t._)("p",null,[M,(0,t._)("a",T,[B,(0,t.Wm)(a)]),D]),P,(0,t._)("p",null,[R,z,S,(0,t._)("a",I,[H,F,(0,t.Wm)(a)])]),G],64)}]])}}]);